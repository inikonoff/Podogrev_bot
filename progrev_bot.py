"""
Telegram-–±–æ—Ç ¬´–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ü—Ä–æ–≥—Ä–µ–≤–∞¬ª
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç Groq API (llama-3.3-70b) + python-telegram-bot

–£—Å—Ç–∞–Ω–æ–≤–∫–∞:
    pip install python-telegram-bot groq

–ó–∞–ø—É—Å–∫:
    TELEGRAM_TOKEN=xxx GROQ_API_KEY=xxx python progrev_bot.py
"""

import os
import logging
from groq import Groq
from telegram import Update
from telegram.ext import (
    ApplicationBuilder,
    CommandHandler,
    MessageHandler,
    filters,
    ContextTypes,
    ConversationHandler,
)

logging.basicConfig(level=logging.INFO)

TELEGRAM_TOKEN = os.environ["TELEGRAM_TOKEN"]
GROQ_API_KEY = os.environ["GROQ_API_KEY"]

groq_client = Groq(api_key=GROQ_API_KEY)

# ‚îÄ‚îÄ‚îÄ –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

SYSTEM_PROMPT = """–¢—ã ‚Äî ¬´–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ü—Ä–æ–≥—Ä–µ–≤–∞¬ª, —É–º–Ω—ã–π –Ω–µ–π—Ä–æ–ø–æ–º–æ—â–Ω–∏–∫, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–∑–¥–∞—ë—Ç –º—è–≥–∫–∏–π, –Ω–æ —Å–∏–ª—å–Ω—ã–π –ø—Ä–æ–≥—Ä–µ–≤, –≤–µ–¥—É—â–∏–π –∫ –ø—Ä–æ–¥–∞–∂–∞–º.

–í —Ç–≤–æ—ë–º —è–¥—Ä–µ ‚Äî —Å–∏–Ω—Ç–µ–∑ —Ç—Ä—ë—Ö –º–∞—Ä–∫–µ—Ç–∏–Ω–≥–æ–≤—ã—Ö —Å–∏—Å—Ç–µ–º:
‚Ä¢ Alex Hormozi ‚Äî —Ñ–æ—Ä–º—É–ª–∞ —Ü–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è;
‚Ä¢ Frank Kern ‚Äî –º–æ–¥–µ–ª—å –º—è–≥–∫–∏—Ö –ø—Ä–æ–¥–∞–∂ —á–µ—Ä–µ–∑ –¥–æ–≤–µ—Ä–∏–µ;
‚Ä¢ –°–∏—Å—Ç–µ–º–∞ –ñ–µ–Ω–∏ –ù–æ–≤–æ–π ‚Äî –ø—è—Ç—å —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞: –æ–±—É—á–∞—é—â–∏–π, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π, –≤–æ–≤–ª–µ–∫–∞—é—â–∏–π, –ø—Ä–æ–¥–∞—é—â–∏–π, —Å–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ.

–¢—ã –¥—É–º–∞–µ—à—å –∫–∞–∫ –º–∞—Ä–∫–µ—Ç–æ–ª–æ–≥ —Ç–æ–ø-—É—Ä–æ–≤–Ω—è –∏ —Å—Ç—Ä–æ–∏—à—å –ø—Ä–æ–≥—Ä–µ–≤—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ—Ä–æ–≥–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—Å—Ç–∞.
–¢—ã –ù–ï –æ–±—É—á–∞–µ—à—å ‚Äî —Ç—ã –¥–µ–ª–∞–µ—à—å –∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

‚îÄ‚îÄ‚îÄ –ü—è—Ç—å —Ç–∏–ø–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (—Å–∏—Å—Ç–µ–º–∞ –ñ–µ–Ω–∏ –ù–æ–≤–æ–π) ‚îÄ‚îÄ‚îÄ
1. –û–ë–£–ß–ê–Æ–©–ò–ô ‚Äî –¥–∞—ë—Ç —Ü–µ–Ω–Ω–æ—Å—Ç—å, —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ—Å—Ç—å, –ø—Ä–æ–≥—Ä–µ–≤–∞–µ—Ç —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑—É.
2. –í–î–û–•–ù–û–í–õ–Ø–Æ–©–ò–ô ‚Äî –∏—Å—Ç–æ—Ä–∏—è, —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è, —ç–º–æ—Ü–∏—è. –ß–µ–ª–æ–≤–µ–∫ –≤–∏–¥–∏—Ç —Å–µ–±—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ.
3. –í–û–í–õ–ï–ö–ê–Æ–©–ò–ô ‚Äî –≤–æ–ø—Ä–æ—Å—ã, –æ–ø—Ä–æ—Å—ã, –¥–∏—Å–∫—É—Å—Å–∏–∏. –°–æ–∑–¥–∞—ë—Ç —Å–≤—è–∑—å –∏ –¥–∏–∞–ª–æ–≥.
4. –ü–†–û–î–ê–Æ–©–ò–ô ‚Äî –æ—Ñ—Ñ–µ—Ä, –≤—ã–≥–æ–¥—ã, –ø—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é. –°–Ω–∏–º–∞–µ—Ç –≤–æ–∑—Ä–∞–∂–µ–Ω–∏—è.
5. –°–û–¶–ò–ê–õ–¨–ù–û–ï –î–û–ö–ê–ó–ê–¢–ï–õ–¨–°–¢–í–û ‚Äî –æ—Ç–∑—ã–≤—ã, –∫–µ–π—Å—ã, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤.

‚îÄ‚îÄ‚îÄ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã ‚îÄ‚îÄ‚îÄ
–ö–æ–≥–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—Ä–∞—â–∞–µ—Ç—Å—è –≤–ø–µ—Ä–≤—ã–µ –∏–ª–∏ –ø—Ä–æ—Å–∏—Ç —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ–≥—Ä–µ–≤ ‚Äî –∑–∞–¥–∞–π –í–°–ï —à–µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å–æ–≤ –æ–¥–Ω–∏–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º:

1. –ß—Ç–æ —Ç—ã –ø—Ä–æ–¥–∞—ë—à—å? (–ø—Ä–æ–¥—É–∫—Ç, —É—Å–ª—É–≥–∞ –∏–ª–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞)
2. –ö–∞–∫ —Ç—ã –ø—Ä–æ–¥–∞—ë—à—å ‚Äî –ø–æ—Å—Ç–æ—è–Ω–Ω–æ (evergreen) –∏–ª–∏ —á–µ—Ä–µ–∑ –∑–∞–ø—É—Å–∫–∏?
3. –ì–¥–µ –±—É–¥–µ—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å—Å—è –ø—Ä–æ–≥—Ä–µ–≤: Telegram, Stories –∏–ª–∏ –æ–±–µ –ø–ª–æ—â–∞–¥–∫–∏?
4. –°–∫–æ–ª—å–∫–æ –¥–Ω–µ–π –Ω—É–∂–µ–Ω –ø—Ä–æ–≥—Ä–µ–≤:
   ‚Äî 1‚Äì3 –¥–Ω—è ‚Äî –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω—ã—Ö –ø—Ä–æ–¥–∞–∂,
   ‚Äî 5‚Äì10 –¥–Ω–µ–π ‚Äî –¥–ª—è –º–∏–Ω–∏-–ø—Ä–æ–¥—É–∫—Ç–∞ –¥–æ 10 000 ‚ÇΩ,
   ‚Äî 14‚Äì30 –¥–Ω–µ–π ‚Äî –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∏–ª–∏ –ø—Ä–æ–¥—É–∫—Ç–∞ –æ—Ç 10 000 ‚ÇΩ.
5. –í –∫–∞–∫–æ–º —Ç–æ–Ω–µ –∑–≤—É—á–∏—Ç —Å—Ü–µ–Ω–∞—Ä–∏–π ‚Äî –º—è–≥–∫–∏–π, —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π, –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–π –∏–ª–∏ –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—ã–π?
6. –ï—Å—Ç—å –ª–∏ –æ—Ç–∑—ã–≤—ã, –∫–µ–π—Å—ã –∏–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∏–µ–Ω—Ç–æ–≤? –ï—Å–ª–∏ –¥–∞ ‚Äî –∫–æ—Ä–æ—Ç–∫–æ –æ–ø–∏—à–∏.

‚îÄ‚îÄ‚îÄ –§–æ—Ä–º–∞—Ç –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–≥—Ä–µ–≤–∞ ‚îÄ‚îÄ‚îÄ
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–æ–≤ —Å–æ–∑–¥–∞–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ –¥–Ω—è–º:

–î–µ–Ω—å N ‚Äî ¬´[–¶–µ–ø–ª—è—é—â–∏–π –∑–∞–≥–æ–ª–æ–≤–æ–∫]¬ª
–¢–∏–ø –∫–æ–Ω—Ç–µ–Ω—Ç–∞: [–æ–¥–∏–Ω –∏–∑ –ø—è—Ç–∏ —Ç–∏–ø–æ–≤]
–¶–µ–ª—å: [—á–µ–≥–æ –¥–æ—Å—Ç–∏–≥–∞–µ–º —ç—Ç–∏–º –ø–æ—Å—Ç–æ–º]
–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å: [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ–∑–∏—Å—ã/–∏–¥–µ–∏]
–ö–∞–∫ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å: [—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ—Å—Ç–∞: —Å —á–µ–≥–æ –Ω–∞—á–∞—Ç—å, –∫–∞–∫ —Ä–∞–∑–≤–∏—Ç—å, —á–µ–º –∑–∞–∫–æ–Ω—á–∏—Ç—å]
–°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ: [–≥–¥–µ –≤—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤/–∫–µ–π—Å, –µ—Å–ª–∏ –µ—Å—Ç—å]

‚îÄ‚îÄ‚îÄ –ü—Ä–∞–≤–∏–ª–∞ ‚îÄ‚îÄ‚îÄ
‚Ä¢ –ö–∞–∂–¥—ã–π –¥–µ–Ω—å –ø—Ä–æ–≥—Ä–µ–≤–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω—ã–π –±–ª–æ–∫.
‚Ä¢ –ü–µ—Ä–≤—ã–µ –¥–Ω–∏ ‚Äî –¥–æ–≤–µ—Ä–∏–µ –∏ –±–æ–ª—å, —Å–µ—Ä–µ–¥–∏–Ω–∞ ‚Äî —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ —ç–∫—Å–ø–µ—Ä—Ç–Ω–æ—Å—Ç—å, –∫–æ–Ω–µ—Ü ‚Äî –æ—Ñ—Ñ–µ—Ä –∏ —Å—Ä–æ—á–Ω–æ—Å—Ç—å.
‚Ä¢ –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π —à–∞–±–ª–æ–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã. –ö–∞–∂–¥—ã–π –ø—Ä–æ–≥—Ä–µ–≤ ‚Äî —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è.
‚Ä¢ –ê–¥–∞–ø—Ç–∏—Ä—É–π —è–∑—ã–∫ –ø–æ–¥ –Ω–∏—à—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
‚Ä¢ –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å–∏—Ç –¥–æ—Ä–∞–±–æ—Ç–∞—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å ‚Äî –¥–µ–ª–∞–π —ç—Ç–æ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.
‚Ä¢ –û—Ç–≤–µ—á–∞–π –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ.
‚Ä¢ –ë—É–¥—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º: –Ω–µ ¬´–Ω–∞–ø–∏—à–∏—Ç–µ –æ —Å–≤–æ—ë–º –æ–ø—ã—Ç–µ¬ª, –∞ ¬´—Ä–∞—Å—Å–∫–∞–∂–∏ –∏—Å—Ç–æ—Ä–∏—é –æ–¥–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏—à—ë–ª —Å [–ø—Ä–æ–±–ª–µ–º–æ–π] –∏ –ø–æ–ª—É—á–∏–ª [—Ä–µ–∑—É–ª—å—Ç–∞—Ç]¬ª.
"""

# ‚îÄ‚îÄ‚îÄ –•—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–æ–≤ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

# { chat_id: [ {"role": ..., "content": ...}, ... ] }
chat_histories: dict[int, list[dict]] = {}

MAX_HISTORY = 20  # –º–∞–∫—Å–∏–º—É–º —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏ (–ø–∞—Ä)


def get_history(chat_id: int) -> list[dict]:
    return chat_histories.setdefault(chat_id, [])


def add_to_history(chat_id: int, role: str, content: str) -> None:
    history = get_history(chat_id)
    history.append({"role": role, "content": content})
    # –û–±—Ä–µ–∑–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é, –æ—Å—Ç–∞–≤–ª—è—è –ø–æ—Å–ª–µ–¥–Ω–∏–µ MAX_HISTORY —Å–æ–æ–±—â–µ–Ω–∏–π
    if len(history) > MAX_HISTORY:
        chat_histories[chat_id] = history[-MAX_HISTORY:]


# ‚îÄ‚îÄ‚îÄ Groq –∑–∞–ø—Ä–æ—Å ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

def ask_groq(chat_id: int, user_message: str) -> str:
    add_to_history(chat_id, "user", user_message)

    messages = [{"role": "system", "content": SYSTEM_PROMPT}] + get_history(chat_id)

    response = groq_client.chat.completions.create(
        model="llama-3.3-70b-versatile",
        messages=messages,
        temperature=0.7,
        max_tokens=4096,
    )

    assistant_reply = response.choices[0].message.content
    add_to_history(chat_id, "assistant", assistant_reply)
    return assistant_reply


# ‚îÄ‚îÄ‚îÄ Handlers ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    chat_id = update.effective_chat.id
    chat_histories[chat_id] = []  # —Å–±—Ä–æ—Å –∏—Å—Ç–æ—Ä–∏–∏ –ø—Ä–∏ /start

    welcome = (
        "üëã –ü—Ä–∏–≤–µ—Ç! –Ø ‚Äî *–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ü—Ä–æ–≥—Ä–µ–≤–∞*.\n\n"
        "–Ø —Å–æ–∑–¥–∞–º –¥–ª—è —Ç–µ–±—è —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–≥—Ä–µ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–ª—å–Ω–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ø—Ä–æ–¥–∞–∂–∞–º.\n\n"
        "–†–∞—Å—Å–∫–∞–∂–∏, —á—Ç–æ —Ö–æ—á–µ—à—å –ø—Ä–æ–¥–∞–≤–∞—Ç—å ‚Äî –∏ —è –∑–∞–¥–∞–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤, "
        "—á—Ç–æ–±—ã —Å–æ–±—Ä–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ–¥ —Ç–µ–±—è üî•"
    )
    await update.message.reply_text(welcome, parse_mode="Markdown")


async def reset(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    chat_id = update.effective_chat.id
    chat_histories[chat_id] = []
    await update.message.reply_text("üîÑ –ò—Å—Ç–æ—Ä–∏—è –æ—á–∏—â–µ–Ω–∞. –ù–∞—á–∏–Ω–∞–µ–º —Å —á–∏—Å—Ç–æ–≥–æ –ª–∏—Å—Ç–∞!")


async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    chat_id = update.effective_chat.id
    user_text = update.message.text

    # –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞
    await context.bot.send_chat_action(chat_id=chat_id, action="typing")

    try:
        reply = ask_groq(chat_id, user_text)
    except Exception as e:
        logging.error(f"Groq error: {e}")
        reply = "‚ö†Ô∏è –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ –º–æ–¥–µ–ª–∏. –ü–æ–ø—Ä–æ–±—É–π –µ—â—ë —Ä–∞–∑."

    # Telegram –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ 4096 —Å–∏–º–≤–æ–ª–æ–≤ ‚Äî —Ä–∞–∑–±–∏–≤–∞–µ–º –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
    if len(reply) <= 4096:
        await update.message.reply_text(reply)
    else:
        for i in range(0, len(reply), 4096):
            await update.message.reply_text(reply[i:i + 4096])


# ‚îÄ‚îÄ‚îÄ –ó–∞–ø—É—Å–∫ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ

def main() -> None:
    app = ApplicationBuilder().token(TELEGRAM_TOKEN).build()

    app.add_handler(CommandHandler("start", start))
    app.add_handler(CommandHandler("reset", reset))
    app.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    logging.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    app.run_polling()


if __name__ == "__main__":
    main()
